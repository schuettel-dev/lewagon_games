= render PageComponent.new do |c|
  - c.heading(@game.game_type.name, :puzzle)

  - c.actions do
    - if policy(@game).admin?
      - unless @game.next_state.nil?
        .flex.flex-col.gap-y-1
          .flex.justify-end
            = button_to @game.decorate.display_button_text_to_move_to_next_state, progress_game_beatle_path(@game), method: :put, class: @game.decorate.class_name_for_button_to_move_to_next_state, form: { "data-turbo-confirm": "Are you sure? You cannot undo this." }
          .text-gray-500.text-xs
            = @game.decorate.display_state_info_for_admin

  - c.body do
    .flex.flex-col.gap-y-8.w-full
      / GUESSES
      - if @game.started?
        .flex.flex-col.gap-y-4.w-full
          %h2.uppercase.cool-text-gradient Your Guesses
          .border.rounded-lg.px-4.py-6.bg-white
            = render Games::Beatles::GuessesComponent.new(game: @game, params:)

      / GENERAL
      .flex.flex-col.gap-y-4.w-full
        %h2.uppercase.cool-text-gradient General
        .grid.grid-cols-4.border.rounded-lg.px-4.py-6.bg-white
          .flex
            = render InfoFactComponent.new do |c|
              - c.term { "Admin" }
              - c.description { render Users::NameWithAvatarComponent.new(user: @game.user) }
          .flex
            = render InfoFactComponent.new do |c|
              - c.term { "State" }
              - c.with_description.with_content(@game.decorate.display_state)

          .flex
            = render InfoFactComponent.new do |c|
              - c.term { "Batch" }
              - c.with_description.with_content(@game.decorate.display_batch)

          .flex
            = render InfoFactComponent.new do |c|
              - c.term { "Players" }
              - c.with_description.with_content(@game.decorate.display_players_count)

      / MY PLAYLIST
      - if policy(@game).show_own_playlist?
        .flex.flex-col.gap-y-4.w-full
          %h2.uppercase.cool-text-gradient My playlist
          - playlist = @game.beatle_playlist_for_user(current_user)
          = turbo_frame_tag playlist do
            .bg-white.rounded-lg.border.flex.flex-col.divide-y.divide-gray-200.w-full
              .p-4
                .flex.items-center.gap-x-4.w-full
                  = link_to "Show my playlist", game_beatle_playlist_path(playlist.game), class: "green-button justify-center w-full"

                  - if policy(playlist).update?
                    = link_to "Edit my playlist", edit_game_beatle_playlist_path(playlist.game), class: "white-button justify-center w-full"

      / PLAYERS
      .flex.flex-col.gap-y-4.w-full
        %h2.uppercase.cool-text-gradient Players
        .bg-white.rounded-lg.border.flex.flex-col.divide-y.divide-gray-200.w-full
          - @game.players.ordered.each do |player|
            .p-4.flex.justify-between.items-center
              .flex.items-center.gap-x-2
                = render Users::NameWithAvatarComponent.new(user: player.user)
              .flex
                = render Games::Beatles::PlayerProgressComponent.new(player:)
